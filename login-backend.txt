
@app.route('/admin_login', methods=['POST'])
def admin_login():
    data = request.get_json()
    identifier = data.get('identifier')
    password = data.get('password')

    if not identifier or not password:
        return jsonify({"message": "Username/Email andm password are required."}), 400

    conn = None
    cursor = None
    try:
        conn = get_db_connection()
        if conn is None:
            return jsonify({"message": "Database connection error."}), 500

        cursor = conn.cursor(dictionary=True)
        query = "SELECT id, username, password_hash, role FROM users WHERE (username = %s OR email = %s) AND role = 'admin'"
        cursor.execute(query, (identifier, identifier))
        user = cursor.fetchone()

        if user and check_password_hash(user['password_hash'], password):
            # return username as well
            return jsonify(
                user_id=user['id'],
                role=user['role'],
                username=user['username']
            ), 200
        else:
            return jsonify({"message": "Invalid admin username/email or password."}), 401
    except Exception as e:
        print(f"ERROR: admin_login - An unexpected error occurred: {str(e)}")
        return jsonify({"message": f"An unexpected error occurred: {str(e)}"}), 500
    finally:
        if cursor:
            cursor.close()
        if conn and conn.is_connected():
            conn.close()